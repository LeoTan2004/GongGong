# 响应接口标准

> [!Note]
>
> 之前的解决方案经常是：
>
> - 统一返回格式，然后利用返回格式中的自定义字段表示不同的状态
> - 其他部分在获取程序之前需要首先解析数据，然后才能获取状态。
> - 如果是非开发者自定义接口，可能返回格式有不统一。比如对于一些全局的报错，fastapi框架会代理返回另外的格式
>
> 这样会导致命名确认数据是否有效只需要通过一个字段就可以了，但是还是需要解析全部返回体，开销和代码规范上都有确定。因此需要通过一些更加使用广泛的方式高速使用者，这个数据和他代表的状态。
>
> 经过仔细的思考，最终选择用HTTP 状态码表示。

## 登陆接口 POST /login

### 请求

| 字段       | 类型     | 说明  | 格式                    |
|----------|--------|-----|-----------------------|
| username | string | 用户名 | x-www-form-urlencoded |
| password | string | 密码  | x-www-form-urlencoded |

### 响应

| HTTP状态码 | 条件         | 说明                                   |
|---------|------------|--------------------------------------|
| 200     | 在校务系统上登陆成功 | 返回体中会携带token作用用户凭证                   |
| 401     | 账户密码错误     | 请求体中不会携带其他数据                         |
| 409     | 当前账户未初始化   | 由于部分用户账户未初始化，教务系统需要用户去更改密码，不改接口数据拿不到 |
| 503     | 校务系统超时     | 由于下游服务教务系统超时，或者验证码为识别成功的情况           |

## 信息获取接口 GET /xxx

## 请求

| 字段    | 类型     | 说明   | 格式     |
|-------|--------|------|--------|
| token | string | 用户凭证 | Header |

### 响应

| HTTP状态码 | 条件           | 说明                                                     |
|---------|--------------|--------------------------------------------------------|
| 200     | 缓存命中，或请求成功   | 返回体中会携带用户所需要的数据                                        |
| 203     | 数据过期或无效（仅代理） | 会返回过期数据或者空数据，建议用户继续请求，直到获取到最新数据                        |
| 401     | token无效      | 不会返回任何值                                                |
| 423     | 账户锁定（仅代理）    | 如果在代理服务重新登陆的时候发生上面登陆接口中的除200和503以外的情况，账户将会被锁定，需要用户重新登陆 |
| 503     | 教务系统超时（仅爬虫）  | 在和校务系统交互时发生超时，则返回这个状态，其中不包含任何有用数据                      |
